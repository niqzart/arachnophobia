<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:pf="http://primefaces.org/ui">
<body>
<ui:composition template="/views/template.xhtml">

  <ui:define name="title">Lab 3 | Main</ui:define>

  <ui:define name="scripts">
    <script src="/static/canvaser.js"></script>
    <script src="/static/validator.js"></script>
  </ui:define>

  <ui:define name="content">
    <table id="content">
      <tbody>
      <tr>
        <td>
          <h:form action="" method="POST" >
            <fieldset>
              <span class="inputs" id="x-p">
                <label>
                  <span class="main-label">X:<br/></span>
                </label>
                <c:forEach var="x" begin="0" end="8">
                  <label>
                    <h:commandButton id="X#{x - 4}"
                                     class="input x-button"
                                     value="#{x - 4}"
                                     action="#{mainBean.setX(x - 4)}">
                      <!--<f:ajax execute="@form" render="@form results"/>-->
                    </h:commandButton>
                    <ui:fragment rendered="#{x == 2 || x == 5}">
                      <br/>
                    </ui:fragment>
                  </label>
                </c:forEach>
              </span>
              <p id="y-p" class="form-part">
                <span class="main-label">Y:</span>
                <pf:inputText id="y-input"
                              type="text"
                              class="input text-input"
                              maxlength="8"
                              value="#{mainBean.y}"
                              widgetVar="y-input"
                >
                  <f:validateDoubleRange minimum="-5" maximum="5"/>
                </pf:inputText>
              </p>
              <p id="r-p" class="form-part">
                <span class="main-label">R:</span>
                <pf:spinner id="r-input"
                            class="input"
                            rotate="true"
                            stepFactor="0.1"
                            min="0.1"
                            max="3"
                            decimalSeparator="."
                            value="#{mainBean.r}"
                            widgetVar="x-input"
                >
                  <f:validateDoubleRange minimum="0.1" maximum="3"/>
                </pf:spinner>
              </p>
              <p class="form-part">
                <pf:commandButton value="Submit"
                                  action="#{mainBean.addPoint}"
                                  widgetVar="submit-button"
                >
                  <!--
                  update="@form"
                  onsuccess="loadPointsFromTable()"
                  -->
                </pf:commandButton>
              </p>
              <p id="messages" style="visibility: hidden"/>
            </fieldset>
          </h:form>
        </td>
        <td>
          <canvas id="point-area" onclick="onClickCanvas(#{mainBean.r})"/>
        </td>
      </tr>
      <tr>
        <td colspan="2" id="result-wrapper">
          <div id="result-container">
            <h:dataTable value="#{mainBean.points}"
                         var="point"
                         id="result-table"
            >
              <h:column>
                <f:facet name="header">X</f:facet>
                <h:outputText value="#{point.x}">
                  <f:convertNumber pattern="###.####"/>
                </h:outputText>
              </h:column>
              <h:column>
                <f:facet name="header">Y</f:facet>
                <h:outputText value="#{point.y}">
                  <f:convertNumber pattern="###.####"/>
                </h:outputText>
              </h:column>
              <h:column>
                <f:facet name="header">R</f:facet>
                #{point.r}
              </h:column>
              <h:column>
                <f:facet name="header">Result</f:facet>
                #{point.inside}
              </h:column>
            </h:dataTable>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </ui:define>

</ui:composition>
</body>

</html>